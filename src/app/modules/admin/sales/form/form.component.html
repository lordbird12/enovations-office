<div class="flex flex-col flex-auto min-w-0">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between p-6 sm:py-8 sm:px-10 border-b bg-card dark:bg-transparent" *ngIf="isForm">
        <div class="flex-1 min-w-0">
            <div class="flex flex-row justify-between">
                <h2 class="text-3xl md:text-4xl font-extrabold tracking-tight leading-7 sm:leading-10 truncate">
                    {{ isForm ? 'สร้างใบจอง ' + (type ?? '-') : 'แก้ไขการจอง' }}
                </h2>
                <div *ngIf="!isForm" class="text-xl font-extrabold">
                    <button class="px-6 ml-3" mat-flat-button color="warn" (click)="onBack()">ย้อนกลับ</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="flex-auto p-6 sm:p-10">
        <div class="grid gap-4 w-full bg-card rounded-lg p-6">
            <form [formGroup]="formData">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-xl font-bold text-gray-500">ข้อมูลการจอง</h3>
                        <mat-form-field class="w-full">
                            <mat-label>วันที่จอง</mat-label>
                            <mat-date-range-input [rangePicker]="picker">
                                <input matStartDate placeholder="วันที่เริ่มต้น" formControlName="start_date">
                                <input matEndDate placeholder="วันที่สิ้นสุด" formControlName="end_date">
                            </mat-date-range-input>
                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-date-range-picker #picker></mat-date-range-picker>
                        </mat-form-field>
                        
                        <mat-form-field class="w-full">
                            <mat-label>วัตถุประสงค์การขอ</mat-label>
                            <mat-select formControlName="request_purpose">
                                <mat-option *ngFor="let item of purpose" [value]="item">{{ item }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        
                        <mat-form-field class="w-full" *ngIf="formData.value.request_purpose === 'Demo'">
                            <mat-label>งบประมาณ</mat-label>
                            <input matInput placeholder="งบประมาณ" formControlName="budget">
                        </mat-form-field>
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-bold text-gray-500">ข้อมูลลูกค้า</h3>
                        <mat-form-field class="w-full">
                            <mat-label>ชื่อโรงพยาบาล</mat-label>
                            <input matInput [formControl]="clientFilter" [matAutocomplete]="clientAutoComplete" placeholder="ค้นหาโรงพยาบาล" />
                            <mat-autocomplete #clientAutoComplete="matAutocomplete" (optionSelected)="onSelectClient($event.option.value, 'manual')">
                                <mat-option *ngFor="let item of filterClient | async" [value]="item.name">{{ item.name }}</mat-option>
                            </mat-autocomplete>
                        </mat-form-field>
                        
                        <mat-form-field class="w-full">
                            <mat-label>จังหวัด</mat-label>
                            <mat-select formControlName="province">
                                <mat-option *ngFor="let item of provinces" [value]="item">{{ item }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                        
                        <mat-form-field class="w-full">
                            <mat-label>แผนก</mat-label>
                            <mat-select formControlName="department">
                                <mat-option *ngFor="let item of departments" [value]="item">{{ item }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
            </form>
            
            <div class="flex justify-center mt-4 space-x-3">
                <button mat-flat-button class="bg-green-700 text-white px-6" (click)="openDialogApprove()">อนุมัติ</button>
                <button mat-flat-button color="primary" (click)="onSubmit()">บันทึก</button>
                <button mat-flat-button color="warn" (click)="onBack()">ยกเลิก</button>
            </div>
        </div>
    </div>
</div>
